a numerical model of the solar system is a set of mathematical equations which when solved give the approximate positions of the planets as a function of time attempts to create such a model established the more general field of celestial mechanics the results of this simulation can be compared with past measurements to check for accuracy and then be used to predict future positions its main use therefore is in preparation of almanacs
== older efforts ==
the simulations can be done in either cartesian or in spherical coordinates the former are easier but extremely calculation intensive and only practical on an electronic computer as such only the latter was used in former times strictly speaking not much less calculation intensive but it was possible to start with some simple approximations and then to add perturbations as much as needed to reach the wanted accuracy
in essence this mathematical simulation of the solar system is a form of the n-body problem the symbol n represents the number of bodies which can grow quite large if one includes 1 sun 8 planets dozens of moons and countless planetoids comets and so forth however the influence of the sun on any other body is so large and the influence of all the other bodies on each other so small that the problem can be reduced to the analytically solvable 2-body problem the result for each planet is an orbit a simple description of its position as function of time once this is solved the influences moons and planets have on each other are added as small corrections these are small compared to a full planetary orbit some corrections might be still several degrees large while measurements can be made to an accuracy of better than 1
although this method is no longer used for simulations it is still useful to find an approximate ephemeris as one can take the relatively simple main solution perhaps add a few of the largest perturbations and arrive without too much effort at the wanted planetary position the disadvantage is that perturbation theory is very advanced mathematics
== modern method ==
the modern method consists of numerical integration in 3-dimensional space one starts with a high accuracy value for the position (x y z) and the velocity (vx vy vz) for each of the bodies involved when also the mass of each body is known the acceleration (ax ay az) can be calculated from newton's law of gravitation each body attracts each other body the total acceleration being the sum of all these attractions next one chooses a small time-step t and applies newton's second law of motion the acceleration multiplied with t gives a correction to the velocity the velocity multiplied with t gives a correction to the position this procedure is repeated for all other bodies
the result is a new value for position and velocity for all bodies then using these new values one starts over the whole calculation for the next time-step t repeating this procedure often enough and one ends up with a description of the positions of all bodies over time
the advantage of this method is that for a computer it is a very easy job to do and it yields highly accurate results for all bodies at the same time doing away with the complex and difficult procedures for determining perturbations the disadvantage is that one must start with highly accurate figures in the first place or the results will drift away from the reality in time that one gets x y z positions which are often first to be transformed into more practical ecliptical or equatorial coordinates before they can be used and that it is an all or nothing approach if one wants to know the position of one planet on one particular time then all other planets and all intermediate time-steps are to be calculated too
== integration ==
in the previous section it was assumed that acceleration remains constant over a small timestep t so that the calculation reduces to simply the addition of v t to r and so forth in reality this is not the case except when one takes t so small that the number of steps to be taken would be prohibitively high because while at any time the position is changed by the acceleration the value of the acceleration is determined by the instantaneous position evidently a full integration is needed
several methods are available first notice the needed equations
this equation describes the acceleration all bodies i running from 1 to n exercise on a particular body j it is a vector equation so it is to be split in 3 equations for each of the x y z components yielding
with the additional relationships
likewise for y and z
the former equation (gravitation) may look foreboding but its calculation is no problem the latter equations (motion laws) seems simpler but yet it cannot be calculated computers cannot integrate they cannot work with infinitesimal values so instead of dt we use t and bringing the resulting variable to the left
 and
remember that a is still a function of time the simplest way to solve these is just the euler algorithm which in essence is the linear addition described above limiting ourselves to 1 dimension only in some general computer language
a.old = gravitationfunction(x.old)
x.new = x.old + v.old * dt
v.new = v.old + a.old * dt
as in essence the acceleration used for the whole duration of the timestep is the one as it was in the beginning of the timestep this simple method has no high accuracy much better results are achieved by taking a mean acceleration the average between the beginning value and the expected (unperturbed) end value
a.old = gravitationfunction(x.old)
x.expect = x.old + v.old * dt
a.expect = gravitationfunction(x.expect)
v.new = v.old + (a.old + a.expect) * 0.5 * dt
x.new = x.old + (v.new + v.old) * 0.5 * dt
of course still better results can be expected by taking intermediate values this is what happens when using the runge-kutta method especially the one of grade 4 or 5 are most useful
a completely different method is the use of taylor series in that case we write
but rather than developing up to some higher derivative in r only one can develop in r and v (that is r') by writing and then write out the factors f and g in a series
all these more advanced methods easily allow for solar system calculations with a stepsize t of 10 days and yet yield satisfactory results
== approximations ==
to calculate the accelerations the gravitational attraction of each body on each other body is to be taken into account as a consequence the amount of calculation in the simulation goes up with the square of the number of bodies doubling the number of bodies increases the work with a factor four to increase the accuracy of the simulation not only more decimals are to be taken but also smaller timesteps again quickly increasing the amount of work evidently tricks are to be applied to reduce the amount of work some of these tricks are given here
by far the most important trick is the use of a proper integration method as already outlined above
the choice of units is important rather than to work in si units which would make some values extremely small and some extremely large all units are to be scaled such that they are in the neighbourhood of 1 for example for distances in the solar system the astronomical unit is most straightforward if this is not done one is almost certain to see a simulation aborted in the middle of a calculation on a floating point overflow or underflow and if not that bad still accuracy is likely to get lost due to truncation errors
if n is large (not so much in solar system simulations but more in galaxy simulations) it is customary to create dynamic groups of bodies all bodies in a particular direction and on large distance from the reference body which is being calculated at that moment are taken together and their gravitational attraction is averaged over the whole group
the total amount of energy and angular momentum of a closed system are conserved quantities by calculating these amounts after every time step the simulation can be programmed to increase the stepsize t if they do not change significantly and to reduce it if they start to do so combining the bodies in groups as in the previous and apply larger and thus less timesteps on the faraway bodies than on the closer ones is also possible
to allow for an excessively rapid change of the acceleration when a particular body is close to the reference body it is customary to introduce a small softness parameter e so that
== complications ==
if the highest possible accuracy is needed things become much more complex in the case of comets nongravitational forces (radiation pressure and gas drag) must be taken into account in the case of mercury (and other planets for long term calculations) relativistic effects cannot be ignored then also the total energy is no longer a constant (because the four vector energy with linear momentum is) the finite speed of light also makes it important to allow for light-time effects both classical and relativistic planets can no longer be considered as particles but their shape and density must also be considered for example the flattening of the earth causes precession which causes the axial tilt to change which affects the long-term movements of all planets long term models (a few tens of millions of years) are not possible due to in stability of the solar system
== see also ==
ephemeris
astronomical algorithm
vsop (planets)
== references ==
boulet dan l (1991) methods of orbit determination for the microcomputer richmond virginia willmann-bell inc isbn 0-943396-34-4 oclc 23287041
